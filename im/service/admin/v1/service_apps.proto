syntax = "proto3";

package webitel.im.service.admin.v1;

option go_package = "github.com/webitel/messaging/proto/gen/webitel/messaging/admin/v1;adpb";

import "service/admin/v1/application.proto";
import "service/admin/v1/application_input.proto";

import "google/rpc/status.proto";

// Applications (Admin) Service
service Applications {
  // Get Application(s) list
  rpc SearchApps(SearchAppRequest) returns (ApplicationList);
  rpc DeleteApps(DeleteAppRequest) returns (ApplicationList);

  rpc CreateApp(CreateAppRequest) returns (webitel.im.service.admin.v1.Application);
  rpc UpdateApp(UpdateAppRequest) returns (webitel.im.service.admin.v1.Application);
  // rpc RevokeApp(RevokeAppRequest) returns ();
}

// 
message ApplicationList {
  // List of Application (configuration) record(s) 
  repeated webitel.im.service.admin.v1.Application data = 1;
  // Number of the current dataset page.
  int32 page = 2;
  // Is there more results ?
  // Is this a partial result ?
  bool next = 3;
}

message SearchAppRequest {
  // Query string as a term of search
  string q = 1;
  // Filter by [client_id]
  string id = 2;

  // Set of (App) fields to be returned into result
  repeated string fields = 3;
  // Page number. Offset
  int32 page = 4;
  // Size number. Limit records per page
  int32 size = 5;
}

message CreateAppRequest {
  // NEW configuration for create
  webitel.im.service.admin.v1.InputApp app = 1;
}

message UpdateAppRequest {
  // App [client_id] for update
  string id = 1;
  // NEW configuration source
  webitel.im.service.admin.v1.InputApp app = 2;
}

message DeleteAppRequest {
  // App [client_id] for delete
  repeated string id = 1;
}

message RevokeAppRequest {
  // App [client_id] to revoke
  string id = 1;
  // The reason. Optional
  google.rpc.Status reason = 2;
  // Delete App permanently ?
  bool delete = 3;
}

