syntax = "proto3";

package webitel.im.service.auth.v1;


option go_package = "github.com/webitel/messaging/proto/gen/webitel/messaging/auth/v1;adpb";

import "service/auth/v1/oauth.proto";
import "service/auth/v1/device_push.proto";
import "service/auth/v1/authorization.proto";

// End-User Account Service
service Account {

  //
  // --- Notifications --- //
  //
  // registerDevice 	Register device to receive PUSH notifications
  // unregisterDevice 	Deletes a device by its token, stops sending PUSH-notifications to it.
  // getNotifySettings 	Gets current notification settings for a given user/group, from all users/all groups.
  // updateNotifySettings 	Edits notification settings from a given user/group, from all users/all groups.
  // resetNotifySettings 	Resets all notification settings from users and groups.
  //
  // --- Users --- //
  //
  // users.getFullUser 	Returns extended user info by ID.
  // users.getUsers 	Returns basic user info according to their identifiers.
  // contacts.resolvePhone 	Resolve a phone number to get user info, if their privacy settings allow it.

  // // Authorization Request. Part of OAuth flow
  // rpc Auth(AuthRequest) returns (AuthResponse);
  
  // Access Token Request
  rpc Token(TokenRequest) returns (Authorization); // (AccessToken);
  // Logout Device Request
  rpc Logout(LogoutRequest) returns (LogoutResponse);
  // Inspect Token Request
  rpc Inspect(InspectRequest) returns (Authorization); // (InspectToken);


  // Register device to receive PUSH notifications
  rpc RegisterDevice(RegisterDeviceRequest) returns (RegisterDeviceResponse);
  // Deletes a device by its token, stops sending PUSH-notifications to it.
  rpc UnregisterDevice(UnregisterDeviceRequest) returns (UnregisterDeviceResponse);
  
  // Get logged-in session(s)
  // https://core.telegram.org/method/account.getAuthorizations
   rpc GetAuthorizations(GetAuthorizationRequest) returns (AuthorizationList);
  
  // rpc GetSessions(GetSessionRequest) returns (SessionList);
  
  // Get my (end-user) device (session) list
  // rpc GetDevices()
}

// PUSH Subscription
// https://core.telegram.org/api/push-updates#subscribing-to-notifications
message RegisterDeviceRequest {
  // PUSH Notification subscription
  PUSHSubscription push = 1;
}

message RegisterDeviceResponse {
  // No Reply ; Error status if failed
}

// PUSH Subscription
// https://core.telegram.org/api/push-updates#subscribing-to-notifications
message UnregisterDeviceRequest {
  // PUSH Notification subscription
  PUSHSubscription push = 1;
}

message UnregisterDeviceResponse {
  // No Reply ; Error status if failed
}